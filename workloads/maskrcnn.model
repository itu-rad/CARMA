======================================================================================================================================================
Layer (type:depth-idx)                             Input Shape               Output Shape              Param #                   Kernel Shape
======================================================================================================================================================
MaskRCNN                                           [3, 800, 1333]            [100, 4]                  --                        --
â”œâ”€GeneralizedRCNNTransform: 1-1                    [3, 800, 1333]            [8, 3, 800, 1344]         --                        --
â”œâ”€BackboneWithFPN: 1-2                             [8, 3, 800, 1344]         [8, 256, 13, 21]          --                        --
â”‚    â””â”€IntermediateLayerGetter: 2-1                [8, 3, 800, 1344]         [8, 2048, 25, 42]         --                        --
â”‚    â”‚    â””â”€Conv2d: 3-1                            [8, 3, 800, 1344]         [8, 64, 400, 672]         9,408                     [7, 7]
â”‚    â”‚    â””â”€BatchNorm2d: 3-2                       [8, 64, 400, 672]         [8, 64, 400, 672]         128                       --
â”‚    â”‚    â””â”€ReLU: 3-3                              [8, 64, 400, 672]         [8, 64, 400, 672]         --                        --
â”‚    â”‚    â””â”€MaxPool2d: 3-4                         [8, 64, 400, 672]         [8, 64, 200, 336]         --                        3
â”‚    â”‚    â””â”€Sequential: 3-5                        [8, 64, 200, 336]         [8, 256, 200, 336]        215,808                   --
â”‚    â”‚    â””â”€Sequential: 3-6                        [8, 256, 200, 336]        [8, 512, 100, 168]        1,219,584                 --
â”‚    â”‚    â””â”€Sequential: 3-7                        [8, 512, 100, 168]        [8, 1024, 50, 84]         7,098,368                 --
â”‚    â”‚    â””â”€Sequential: 3-8                        [8, 1024, 50, 84]         [8, 2048, 25, 42]         14,964,736                --
â”‚    â””â”€FeaturePyramidNetwork: 2-2                  [8, 256, 200, 336]        [8, 256, 13, 21]          --                        --
â”‚    â”‚    â””â”€ModuleList: 3-15                       --                        --                        (recursive)               --
â”‚    â”‚    â””â”€ModuleList: 3-16                       --                        --                        (recursive)               --
â”‚    â”‚    â””â”€ModuleList: 3-15                       --                        --                        (recursive)               --
â”‚    â”‚    â””â”€ModuleList: 3-16                       --                        --                        (recursive)               --
â”‚    â”‚    â””â”€ModuleList: 3-15                       --                        --                        (recursive)               --
â”‚    â”‚    â””â”€ModuleList: 3-16                       --                        --                        (recursive)               --
â”‚    â”‚    â””â”€ModuleList: 3-15                       --                        --                        (recursive)               --
â”‚    â”‚    â””â”€ModuleList: 3-16                       --                        --                        (recursive)               --
â”‚    â”‚    â””â”€LastLevelMaxPool: 3-17                 [8, 256, 200, 336]        [8, 256, 200, 336]        --                        --
â”œâ”€RegionProposalNetwork: 1-3                       [8, 3, 800, 1344]         [666, 4]                  --                        --
â”‚    â””â”€RPNHead: 2-3                                [8, 256, 200, 336]        [8, 3, 200, 336]          --                        --
â”‚    â”‚    â””â”€Sequential: 3-18                       [8, 256, 200, 336]        [8, 256, 200, 336]        590,080                   --
â”‚    â”‚    â””â”€Conv2d: 3-19                           [8, 256, 200, 336]        [8, 3, 200, 336]          771                       [1, 1]
â”‚    â”‚    â””â”€Conv2d: 3-20                           [8, 256, 200, 336]        [8, 12, 200, 336]         3,084                     [1, 1]
â”‚    â”‚    â””â”€Sequential: 3-21                       [8, 256, 100, 168]        [8, 256, 100, 168]        (recursive)               --
â”‚    â”‚    â””â”€Conv2d: 3-22                           [8, 256, 100, 168]        [8, 3, 100, 168]          (recursive)               [1, 1]
â”‚    â”‚    â””â”€Conv2d: 3-23                           [8, 256, 100, 168]        [8, 12, 100, 168]         (recursive)               [1, 1]
â”‚    â”‚    â””â”€Sequential: 3-24                       [8, 256, 50, 84]          [8, 256, 50, 84]          (recursive)               --
â”‚    â”‚    â””â”€Conv2d: 3-25                           [8, 256, 50, 84]          [8, 3, 50, 84]            (recursive)               [1, 1]
â”‚    â”‚    â””â”€Conv2d: 3-26                           [8, 256, 50, 84]          [8, 12, 50, 84]           (recursive)               [1, 1]
â”‚    â”‚    â””â”€Sequential: 3-27                       [8, 256, 25, 42]          [8, 256, 25, 42]          (recursive)               --
â”‚    â”‚    â””â”€Conv2d: 3-28                           [8, 256, 25, 42]          [8, 3, 25, 42]            (recursive)               [1, 1]
â”‚    â”‚    â””â”€Conv2d: 3-29                           [8, 256, 25, 42]          [8, 12, 25, 42]           (recursive)               [1, 1]
â”‚    â”‚    â””â”€Sequential: 3-30                       [8, 256, 13, 21]          [8, 256, 13, 21]          (recursive)               --
â”‚    â”‚    â””â”€Conv2d: 3-31                           [8, 256, 13, 21]          [8, 3, 13, 21]            (recursive)               [1, 1]
â”‚    â”‚    â””â”€Conv2d: 3-32                           [8, 256, 13, 21]          [8, 12, 13, 21]           (recursive)               [1, 1]
â”‚    â””â”€AnchorGenerator: 2-4                        [8, 3, 800, 1344]         [268569, 4]               --                        --
â”œâ”€RoIHeads: 1-4                                    [8, 256, 200, 336]        [100, 4]                  --                        --
â”‚    â””â”€MultiScaleRoIAlign: 2-5                     [8, 256, 200, 336]        [5190, 256, 7, 7]         --                        --
â”‚    â””â”€TwoMLPHead: 2-6                             [5190, 256, 7, 7]         [5190, 1024]              --                        --
â”‚    â”‚    â””â”€Linear: 3-33                           [5190, 12544]             [5190, 1024]              12,846,080                --
â”‚    â”‚    â””â”€Linear: 3-34                           [5190, 1024]              [5190, 1024]              1,049,600                 --
â”‚    â””â”€FastRCNNPredictor: 2-7                      [5190, 1024]              [5190, 91]                --                        --
â”‚    â”‚    â””â”€Linear: 3-35                           [5190, 1024]              [5190, 91]                93,275                    --
â”‚    â”‚    â””â”€Linear: 3-36                           [5190, 1024]              [5190, 364]               373,100                   --
â”‚    â””â”€MultiScaleRoIAlign: 2-8                     [8, 256, 200, 336]        [800, 256, 14, 14]        --                        --
â”‚    â””â”€MaskRCNNHeads: 2-9                          [800, 256, 14, 14]        [800, 256, 14, 14]        --                        --
â”‚    â”‚    â””â”€Conv2dNormActivation: 3-37             [800, 256, 14, 14]        [800, 256, 14, 14]        590,080                   --
â”‚    â”‚    â””â”€Conv2dNormActivation: 3-38             [800, 256, 14, 14]        [800, 256, 14, 14]        590,080                   --
â”‚    â”‚    â””â”€Conv2dNormActivation: 3-39             [800, 256, 14, 14]        [800, 256, 14, 14]        590,080                   --
â”‚    â”‚    â””â”€Conv2dNormActivation: 3-40             [800, 256, 14, 14]        [800, 256, 14, 14]        590,080                   --
â”‚    â””â”€MaskRCNNPredictor: 2-10                     [800, 256, 14, 14]        [800, 91, 28, 28]         --                        --
â”‚    â”‚    â””â”€ConvTranspose2d: 3-41                  [800, 256, 14, 14]        [800, 256, 28, 28]        262,400                   [2, 2]
â”‚    â”‚    â””â”€ReLU: 3-42                             [800, 256, 28, 28]        [800, 256, 28, 28]        --                        --
â”‚    â”‚    â””â”€Conv2d: 3-43                           [800, 256, 28, 28]        [800, 91, 28, 28]         23,387                    [1, 1]
======================================================================================================================================================
Total params: 44,454,513
Trainable params: 44,454,513
Non-trainable params: 0
Total mult-adds (Units.TERABYTES): 2.24
======================================================================================================================================================
Input size (MB): 102.37
Forward/backward pass size (MB): 38090.84
Params size (MB): 177.82
Estimated Total Size (MB): 38371.03
======================================================================================================================================================



batch size B=8.

Parameters (P): 44,454,513

Activations (batch total AÃ—B): 1,671,450,730 elements
(per-sample A â‰ˆ 208,931,341)

Horus (your formula, gradients = parameters):

elts
=
(
ğ´
â€‰â£
Ã—
â€‰â£
ğµ
+
ğ‘ƒ
)
+
(
ğµ
â€‰â£
Ã—
â€‰â£
ğ‘ƒ
)
=
ğ´
â€‰â£
Ã—
â€‰â£
ğµ
+
(
1
+
ğµ
)
ğ‘ƒ
elts=(AÃ—B+P)+(BÃ—P)=AÃ—B+(1+B)P

= 
1,671,450,730
+
9
Ã—
44,454,513
=
2,071,541,347
1,671,450,730+9Ã—44,454,513=2,071,541,347 elts

FP32: 7,902.30 MB (~7.72 GB)